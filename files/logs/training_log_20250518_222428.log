2025-05-18 22:24:28,652 - __main__ - INFO - 环境准备与日志配置完成。
2025-05-18 22:24:28,652 - __main__ - INFO - 文本日志将保存到: ./files/logs/training_log_20250518_222428.log
2025-05-18 22:24:28,653 - __main__ - INFO - TensorBoard 日志将保存到: ./files/logs/tensorboard_runs/20250518-222428
2025-05-18 22:24:28,653 - __main__ - INFO - PyTorch 版本: 2.5.1+cu124
2025-05-18 22:24:28,653 - __main__ - INFO - Transformers 版本: 4.51.3
2025-05-18 22:24:28,654 - __main__ - INFO - Datasets 版本: 3.3.2
2025-05-18 22:24:28,654 - __main__ - INFO - Evaluate 版本: 0.4.3
2025-05-18 22:24:28,654 - __main__ - INFO - 将使用设备: cuda
2025-05-18 22:24:28,655 - __main__ - INFO - CUDA 可用. GPU数量: 1
2025-05-18 22:24:28,655 - __main__ - INFO -   GPU 0: NVIDIA GeForce RTX 3090
2025-05-18 22:24:28,656 - __main__ - INFO - 当前默认GPU: NVIDIA GeForce RTX 3090
2025-05-18 22:24:28,657 - __main__ - INFO - 所有配置参数定义完毕。
2025-05-18 22:24:28,658 - __main__ - INFO - 文本日志文件: ./files/logs/training_log_20250518_222428.log
2025-05-18 22:24:28,658 - __main__ - INFO - TensorBoard 日志目录: ./files/logs/tensorboard_runs/20250518-222428
2025-05-18 22:24:28,658 - __main__ - INFO - 原始数据目录: ./files/raw_data
2025-05-18 22:24:28,659 - __main__ - INFO -   增强数据文件: ./files/raw_data/train_add.txt
2025-05-18 22:24:28,659 - __main__ - INFO - 缓存数据目录: ./files/processed_data_cache
2025-05-18 22:24:28,659 - __main__ - INFO - 模型保存目录: ./files/saved_models
2025-05-18 22:24:28,659 - __main__ - INFO -   初次最佳模型: ./files/saved_models/best_roberta_model.pt
2025-05-18 22:24:28,660 - __main__ - INFO -   二次最佳模型: ./files/saved_models/best_augmented_model.pt
2025-05-18 22:24:28,660 - __main__ - INFO - 最终预测结果目录: ./files/results
2025-05-18 22:24:28,660 - __main__ - INFO -   最终预测JSON: ./files/results/final_test_top1_predictions.json
2025-05-18 22:24:28,661 - __main__ - INFO -   最终预测TXT: ./files/results/result.txt
2025-05-18 22:24:28,661 - __main__ - INFO - 初步分析结果目录: ./files/analysis_results
2025-05-18 22:24:28,662 - __main__ - INFO -   初步分析JSON: ./files/analysis_results/all_test_analysis/test_top1_predictions.json
2025-05-18 22:24:28,662 - __main__ - INFO - 最终预测分析图表/CSV目录: ./files/results/prediction_analysis_charts_csv
2025-05-18 22:24:28,662 - __main__ - INFO -   最终分析图: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution.png
2025-05-18 22:24:45,375 - __main__ - INFO - ============================== 开始使用增强数据进行二次微调 ==============================
2025-05-18 22:24:45,376 - __main__ - INFO - 检查二次微调所需的前置变量...
2025-05-18 22:24:45,377 - __main__ - INFO - 所有二次微调所需的前置变量均已定义。
2025-05-18 22:24:45,377 - __main__ - INFO - 开始加载数据增强文件: ./files/raw_data/train_add.txt
2025-05-18 22:24:45,377 - __main__ - INFO - 开始从文件加载数据: ./files/raw_data/train_add.txt
2025-05-18 22:24:45,441 - __main__ - INFO - 从 ./files/raw_data/train_add.txt 成功加载 66879 条数据
2025-05-18 22:24:45,464 - __main__ - INFO - 成功从 ./files/raw_data/train_add.txt 加载 66879 条增强训练数据。
2025-05-18 22:24:45,465 - __main__ - INFO - 开始预处理增强训练数据...
2025-05-18 22:24:45,465 - __main__ - INFO - 发现预处理好的增强训练数据缓存，正在从磁盘加载: ./files/processed_data_cache/aug_train_dataset_cache
2025-05-18 22:24:45,470 - __main__ - INFO - 从磁盘加载预处理增强训练数据成功。
2025-05-18 22:24:45,471 - __main__ - INFO - 增强训练数据集格式已设置为 PyTorch Tensors。
2025-05-18 22:24:45,471 - __main__ - INFO - 创建增强训练数据的 DataLoader...
2025-05-18 22:24:45,472 - __main__ - INFO - 增强训练数据 DataLoader 创建成功 (Batch Size: 256, Num Workers: 0)。
2025-05-18 22:24:45,472 - __main__ - INFO - 加载第一阶段微调后的最佳模型权重从: ./files/saved_models/best_roberta_model.pt
2025-05-18 22:24:46,276 - __main__ - INFO - 成功加载来自 './files/saved_models/best_roberta_model.pt' 的模型权重。
2025-05-18 22:24:46,277 - __main__ - INFO - 为二次微调配置新的优化器和学习率调度器...
2025-05-18 22:24:46,278 - __main__ - INFO - 二次微调超参数: Learning Rate=2e-05, Epochs=6, Warmup Proportion=0.1, Weight Decay=0.01
2025-05-18 22:24:46,279 - __main__ - INFO - 二次微调 AdamW 优化器创建成功。
2025-05-18 22:24:46,280 - __main__ - INFO - 二次微调总训练步数: 1572, 预热步数: 157
2025-05-18 22:24:46,284 - __main__ - INFO - 二次微调学习率调度器创建成功。
2025-05-18 22:24:46,285 - __main__ - INFO - 开始二次微调训练与验证循环...
2025-05-18 22:24:46,285 - __main__ - INFO - 二次微调按步数验证：每 262 步 (约占epoch的 100.0%) 进行一次验证。
2025-05-18 22:24:46,287 - __main__ - INFO - --- 二次微调 Epoch 1/6 ---
2025-05-18 22:28:05,956 - __main__ - INFO - 开始验证... Aug Epoch 1, Step 262/262
2025-05-18 22:29:32,805 - __main__ - INFO - 验证完成. 平均验证损失: 0.0448
2025-05-18 22:29:32,917 - __main__ - INFO -   验证准确率 (Accuracy): 0.9860
2025-05-18 22:29:33,031 - __main__ - INFO -   验证加权 F1-Score: 0.9860
2025-05-18 22:29:33,034 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9860 at Aug Epoch 1, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 22:29:34,643 - __main__ - INFO - 二次微调 Epoch 1 训练阶段完成. 平均训练损失: 0.0065
2025-05-18 22:29:34,644 - __main__ - INFO - 二次微调 Epoch 1 总耗时: 288.36 秒
2025-05-18 22:29:34,644 - __main__ - INFO - --- 二次微调 Epoch 2/6 ---
2025-05-18 22:33:25,213 - __main__ - INFO - 开始验证... Aug Epoch 2, Step 262/262
2025-05-18 22:34:52,179 - __main__ - INFO - 验证完成. 平均验证损失: 0.0357
2025-05-18 22:34:52,325 - __main__ - INFO -   验证准确率 (Accuracy): 0.9886
2025-05-18 22:34:52,504 - __main__ - INFO -   验证加权 F1-Score: 0.9886
2025-05-18 22:34:52,507 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9886 at Aug Epoch 2, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 22:34:54,223 - __main__ - INFO - 二次微调 Epoch 2 训练阶段完成. 平均训练损失: 0.0103
2025-05-18 22:34:54,224 - __main__ - INFO - 二次微调 Epoch 2 总耗时: 319.58 秒
2025-05-18 22:34:54,225 - __main__ - INFO - --- 二次微调 Epoch 3/6 ---
2025-05-18 22:38:45,194 - __main__ - INFO - 开始验证... Aug Epoch 3, Step 262/262
2025-05-18 22:40:12,321 - __main__ - INFO - 验证完成. 平均验证损失: 0.0264
2025-05-18 22:40:12,412 - __main__ - INFO -   验证准确率 (Accuracy): 0.9918
2025-05-18 22:40:12,520 - __main__ - INFO -   验证加权 F1-Score: 0.9918
2025-05-18 22:40:12,523 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9918 at Aug Epoch 3, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 22:40:13,875 - __main__ - INFO - 二次微调 Epoch 3 训练阶段完成. 平均训练损失: 0.0032
2025-05-18 22:40:13,876 - __main__ - INFO - 二次微调 Epoch 3 总耗时: 319.65 秒
2025-05-18 22:40:13,877 - __main__ - INFO - --- 二次微调 Epoch 4/6 ---
2025-05-18 22:43:35,637 - __main__ - INFO - 开始验证... Aug Epoch 4, Step 262/262
2025-05-18 22:45:02,339 - __main__ - INFO - 验证完成. 平均验证损失: 0.0308
2025-05-18 22:45:02,435 - __main__ - INFO -   验证准确率 (Accuracy): 0.9910
2025-05-18 22:45:02,556 - __main__ - INFO -   验证加权 F1-Score: 0.9911
2025-05-18 22:45:02,559 - __main__ - INFO - 当前验证 Accuracy 0.9910 未超过二次微调历史最佳 0.9918 (at Aug Epoch 4, Step 262/262).
2025-05-18 22:45:02,561 - __main__ - INFO - 二次微调 Epoch 4 训练阶段完成. 平均训练损失: 0.0016
2025-05-18 22:45:02,562 - __main__ - INFO - 二次微调 Epoch 4 总耗时: 288.69 秒
2025-05-18 22:45:02,562 - __main__ - INFO - --- 二次微调 Epoch 5/6 ---
2025-05-18 22:49:23,092 - __main__ - INFO - 开始验证... Aug Epoch 5, Step 262/262
2025-05-18 22:50:49,420 - __main__ - INFO - 验证完成. 平均验证损失: 0.0280
2025-05-18 22:50:49,511 - __main__ - INFO -   验证准确率 (Accuracy): 0.9917
2025-05-18 22:50:49,617 - __main__ - INFO -   验证加权 F1-Score: 0.9917
2025-05-18 22:50:49,619 - __main__ - INFO - 当前验证 Accuracy 0.9917 未超过二次微调历史最佳 0.9918 (at Aug Epoch 5, Step 262/262).
2025-05-18 22:50:49,621 - __main__ - INFO - 二次微调 Epoch 5 训练阶段完成. 平均训练损失: 0.0006
2025-05-18 22:50:49,622 - __main__ - INFO - 二次微调 Epoch 5 总耗时: 347.06 秒
2025-05-18 22:50:49,623 - __main__ - INFO - --- 二次微调 Epoch 6/6 ---
2025-05-18 22:54:40,368 - __main__ - INFO - 开始验证... Aug Epoch 6, Step 262/262
2025-05-18 22:56:06,359 - __main__ - INFO - 验证完成. 平均验证损失: 0.0277
2025-05-18 22:56:06,450 - __main__ - INFO -   验证准确率 (Accuracy): 0.9918
2025-05-18 22:56:06,558 - __main__ - INFO -   验证加权 F1-Score: 0.9918
2025-05-18 22:56:06,561 - __main__ - INFO - 当前验证 Accuracy 0.9918 未超过二次微调历史最佳 0.9918 (at Aug Epoch 6, Step 262/262).
2025-05-18 22:56:06,562 - __main__ - INFO - 二次微调 Epoch 6 训练阶段完成. 平均训练损失: 0.0004
2025-05-18 22:56:06,563 - __main__ - INFO - 二次微调 Epoch 6 总耗时: 316.94 秒
2025-05-18 22:56:06,564 - __main__ - INFO - 所有计划的二次微调 Epoch 训练与验证完成。
2025-05-18 22:56:06,564 - __main__ - INFO - 二次微调期间记录的最佳模型信息: Epoch=3, Step=262, Val Accuracy=0.9918, Val F1=0.9918, Val Loss=0.0264
2025-05-18 22:56:06,565 - __main__ - INFO - 最佳二次微调模型参数已保存至: ./files/saved_models/best_augmented_model.pt (对应验证准确率: 0.9918)
2025-05-18 22:56:06,565 - __main__ - INFO - 总二次微调耗时: 00小时 31分钟 20.28秒
2025-05-18 22:56:06,566 - __main__ - INFO - ============================== 使用增强数据进行二次微调结束 ==============================

2025-05-18 22:56:36,621 - __main__ - INFO - ============================== 开始最终测试集预测与结果分析 (使用二次微调模型) ==============================
2025-05-18 22:56:36,623 - __main__ - INFO - 检查最终预测与分析所需的前置变量...
2025-05-18 22:56:36,624 - __main__ - INFO - 所有最终预测分析所需的前置变量均已定义。
2025-05-18 22:56:36,624 - __main__ - INFO - 加载二次微调后的最佳模型权重从: ./files/saved_models/best_augmented_model.pt
2025-05-18 22:56:37,318 - __main__ - INFO - 二次微调后的最佳模型权重从 ./files/saved_models/best_augmented_model.pt 加载成功。
2025-05-18 22:56:37,336 - __main__ - INFO - 开始对所有测试数据进行最终 Top-1 预测 (使用二次微调模型)...
2025-05-18 22:58:07,383 - __main__ - INFO - 最终 Top-1 预测处理完成，共获得 83599 条预测结果。
2025-05-18 22:58:07,823 - __main__ - INFO - 最终测试集 Top-1 预测结果已保存至 JSON: ./files/results/final_test_top1_predictions.json
2025-05-18 22:58:07,824 - __main__ - INFO - JSON结果示例 (第一条):
2025-05-18 22:58:07,824 - __main__ - INFO - {
  "original_id": 0,
  "text": "北京君太百货璀璨秋色 满100省353020元",
  "predicted_label": "房产",
  "probability": 0.965
}
2025-05-18 22:58:07,856 - __main__ - INFO - 成功将 83599 条预测标签写入纯文本文件: ./files/results/result.txt
2025-05-18 22:58:07,857 - __main__ - INFO - result.txt 内容示例 (前3行，如果存在):
2025-05-18 22:58:07,857 - __main__ - INFO -   房产
2025-05-18 22:58:07,858 - __main__ - INFO -   时政
2025-05-18 22:58:07,858 - __main__ - INFO -   科技
2025-05-18 22:58:07,858 - __main__ - INFO - 开始统计和绘制最终 Top-1 预测概率分布图...
2025-05-18 22:58:08,691 - __main__ - INFO - 最终概率分布柱状图已保存至: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution.png
2025-05-18 22:58:08,810 - __main__ - INFO - 最终概率分布图已尝试记录到 TensorBoard。
2025-05-18 22:58:08,826 - __main__ - INFO - 最终概率分布数据已保存至 CSV: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution_data.csv
2025-05-18 22:58:08,827 - __main__ - INFO - ============================== 最终测试集预测与结果分析结束 ==============================

