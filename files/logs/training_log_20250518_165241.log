2025-05-18 16:52:41,917 - __main__ - INFO - 环境准备与日志配置完成。
2025-05-18 16:52:41,918 - __main__ - INFO - 文本日志将保存到: ./files/logs/training_log_20250518_165241.log
2025-05-18 16:52:41,919 - __main__ - INFO - TensorBoard 日志将保存到: ./files/logs/tensorboard_runs/20250518-165241
2025-05-18 16:52:41,919 - __main__ - INFO - PyTorch 版本: 2.5.1+cu124
2025-05-18 16:52:41,919 - __main__ - INFO - Transformers 版本: 4.51.3
2025-05-18 16:52:41,920 - __main__ - INFO - Datasets 版本: 3.3.2
2025-05-18 16:52:41,920 - __main__ - INFO - Evaluate 版本: 0.4.3
2025-05-18 16:52:41,943 - __main__ - INFO - 将使用设备: cuda
2025-05-18 16:52:41,960 - __main__ - INFO - CUDA 可用. GPU数量: 1
2025-05-18 16:52:41,963 - __main__ - INFO -   GPU 0: NVIDIA GeForce RTX 3090
2025-05-18 16:52:41,963 - __main__ - INFO - 当前默认GPU: NVIDIA GeForce RTX 3090
2025-05-18 16:52:41,965 - __main__ - INFO - 所有配置参数定义完毕。
2025-05-18 16:52:41,966 - __main__ - INFO - 文本日志文件: ./files/logs/training_log_20250518_165241.log
2025-05-18 16:52:41,966 - __main__ - INFO - TensorBoard 日志目录: ./files/logs/tensorboard_runs/20250518-165241
2025-05-18 16:52:41,966 - __main__ - INFO - 原始数据目录: ./files/raw_data
2025-05-18 16:52:41,967 - __main__ - INFO -   增强数据文件: ./files/raw_data/train_add.txt
2025-05-18 16:52:41,967 - __main__ - INFO - 缓存数据目录: ./files/processed_data_cache
2025-05-18 16:52:41,967 - __main__ - INFO - 模型保存目录: ./files/saved_models
2025-05-18 16:52:41,968 - __main__ - INFO -   初次最佳模型: ./files/saved_models/best_roberta_model.pt
2025-05-18 16:52:41,968 - __main__ - INFO -   二次最佳模型: ./files/saved_models/best_augmented_model.pt
2025-05-18 16:52:41,968 - __main__ - INFO - 最终预测结果目录: ./files/results
2025-05-18 16:52:41,968 - __main__ - INFO -   最终预测JSON: ./files/results/final_test_top1_predictions.json
2025-05-18 16:52:41,969 - __main__ - INFO -   最终预测TXT: ./files/results/result.txt
2025-05-18 16:52:41,969 - __main__ - INFO - 初步分析结果目录: ./files/analysis_results
2025-05-18 16:52:41,969 - __main__ - INFO -   初步分析JSON: ./files/analysis_results/all_test_analysis/test_top1_predictions.json
2025-05-18 16:52:41,970 - __main__ - INFO - 最终预测分析图表/CSV目录: ./files/results/prediction_analysis_charts_csv
2025-05-18 16:52:41,970 - __main__ - INFO -   最终分析图: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution.png
2025-05-18 16:52:45,033 - __main__ - INFO - ============================== 开始数据加载与标签映射 ==============================
2025-05-18 16:52:45,034 - __main__ - INFO - -------------------- 加载训练集 --------------------
2025-05-18 16:52:45,035 - __main__ - INFO - 开始从文件加载数据: ./files/raw_data/train.txt
2025-05-18 16:52:45,692 - __main__ - INFO - 从 ./files/raw_data/train.txt 成功加载 752471 条数据
2025-05-18 16:52:45,692 - __main__ - INFO - -------------------- 加载验证集 --------------------
2025-05-18 16:52:45,693 - __main__ - INFO - 开始从文件加载数据: ./files/raw_data/dev.txt
2025-05-18 16:52:45,762 - __main__ - INFO - 从 ./files/raw_data/dev.txt 成功加载 80000 条数据
2025-05-18 16:52:45,763 - __main__ - INFO - -------------------- 加载测试集 --------------------
2025-05-18 16:52:45,764 - __main__ - INFO - 开始从文件加载数据: ./files/raw_data/test.txt
2025-05-18 16:52:45,814 - __main__ - INFO - 从 ./files/raw_data/test.txt 成功加载 83599 条数据
2025-05-18 16:52:45,815 - __main__ - INFO - 开始从训练集构建类别标签映射...
2025-05-18 16:52:45,885 - __main__ - INFO - 共找到 14 个唯一类别: ['体育', '娱乐', '家居', '彩票', '房产', '教育', '时尚', '时政', '星座', '游戏', '社会', '科技', '股票', '财经']
2025-05-18 16:52:45,886 - __main__ - INFO - 类别到ID的映射 (label_to_id): {'体育': 0, '娱乐': 1, '家居': 2, '彩票': 3, '房产': 4, '教育': 5, '时尚': 6, '时政': 7, '星座': 8, '游戏': 9, '社会': 10, '科技': 11, '股票': 12, '财经': 13}
2025-05-18 16:52:45,886 - __main__ - INFO - ID到类别的映射 (id_to_label): {0: '体育', 1: '娱乐', 2: '家居', 3: '彩票', 4: '房产', 5: '教育', 6: '时尚', 7: '时政', 8: '星座', 9: '游戏', 10: '社会', 11: '科技', 12: '股票', 13: '财经'}
2025-05-18 16:52:45,887 - __main__ - INFO - 原始数据加载和标签映射完成
2025-05-18 16:52:45,887 - __main__ - INFO - ============================== 数据加载与标签映射结束 ==============================

2025-05-18 16:52:47,400 - __main__ - INFO - ============================== 开始数据预处理 ==============================
2025-05-18 16:52:47,401 - __main__ - INFO - 尝试加载 Tokenizer...
2025-05-18 16:52:47,401 - __main__ - INFO - 从本地路径 '/root/.cache/huggingface/hub/models--hfl--chinese-roberta-wwm-ext-large/snapshots/a25cc9e05974bd9687e528edd516f2cfdb3f5db9' 加载 Tokenizer...
2025-05-18 16:52:47,427 - __main__ - INFO - Tokenizer 从本地路径 '/root/.cache/huggingface/hub/models--hfl--chinese-roberta-wwm-ext-large/snapshots/a25cc9e05974bd9687e528edd516f2cfdb3f5db9' 加载成功
2025-05-18 16:52:47,428 - __main__ - INFO - 开始实例化或加载预处理后的 HuggingFace Dataset 对象...
2025-05-18 16:52:47,429 - __main__ - INFO - 预处理数据集缓存不完整或不存在，将重新处理所有数据集...
2025-05-18 16:52:47,429 - __main__ - INFO - 开始为 '训练集' 创建 HuggingFace Dataset 对象...
2025-05-18 16:52:48,176 - __main__ - INFO - '训练集' Dataset 对象创建成功，包含 752471 条记录
2025-05-18 16:52:48,177 - __main__ - INFO - 开始对 '训练集' 进行并行预处理 (使用 12 个进程)...
2025-05-18 16:52:59,689 - __main__ - INFO - '训练集' 预处理完成
2025-05-18 16:52:59,694 - __main__ - INFO - 保存预处理后的训练集到: ./files/processed_data_cache/train_dataset_cache
2025-05-18 16:53:00,030 - __main__ - INFO - 开始为 '验证集' 创建 HuggingFace Dataset 对象...
2025-05-18 16:53:00,083 - __main__ - INFO - '验证集' Dataset 对象创建成功，包含 80000 条记录
2025-05-18 16:53:00,083 - __main__ - INFO - 开始对 '验证集' 进行并行预处理 (使用 12 个进程)...
2025-05-18 16:53:02,532 - __main__ - INFO - '验证集' 预处理完成
2025-05-18 16:53:02,533 - __main__ - INFO - 保存预处理后的验证集到: ./files/processed_data_cache/dev_dataset_cache
2025-05-18 16:53:02,587 - __main__ - INFO - 开始为 '测试集' 创建 HuggingFace Dataset 对象...
2025-05-18 16:53:02,649 - __main__ - INFO - '测试集' Dataset 对象创建成功，包含 83599 条记录
2025-05-18 16:53:02,650 - __main__ - INFO - 开始对 '测试集' 进行并行预处理 (使用 12 个进程)...
2025-05-18 16:53:05,059 - __main__ - INFO - '测试集' 预处理完成
2025-05-18 16:53:05,060 - __main__ - INFO - 保存预处理后的测试集到: ./files/processed_data_cache/test_dataset_cache
2025-05-18 16:53:05,108 - __main__ - INFO - 所有数据集预处理完成并已保存到磁盘缓存
2025-05-18 16:53:05,108 - __main__ - INFO - HuggingFace Dataset 对象实例化/加载成功
2025-05-18 16:53:05,109 - __main__ - INFO - 设置数据集格式为 PyTorch Tensors...
2025-05-18 16:53:05,110 - __main__ - INFO - 数据集格式设置完成
2025-05-18 16:53:05,110 - __main__ - INFO - -------------------- 检查处理后的训练样本 --------------------
2025-05-18 16:53:05,113 - __main__ - INFO -   样本类型: <class 'dict'>
2025-05-18 16:53:05,113 - __main__ - INFO -   样本键: ['input_ids', 'attention_mask', 'labels']
2025-05-18 16:53:05,114 - __main__ - INFO -     'input_ids': shape=torch.Size([28]), dtype=torch.int64
2025-05-18 16:53:05,114 - __main__ - INFO -     'attention_mask': shape=torch.Size([28]), dtype=torch.int64
2025-05-18 16:53:05,114 - __main__ - INFO -     'labels': shape=torch.Size([]), dtype=torch.int64
2025-05-18 16:53:05,115 - __main__ - INFO -   解码后的 Input IDs (预览): '网 易 第 三 季 度 业 绩 低 于 分 析 师 预 期'
2025-05-18 16:53:05,115 - __main__ - INFO -   对应的原始文本 (预览): '网易第三季度业绩低于分析师预期'
2025-05-18 16:53:05,115 - __main__ - INFO - ============================== 数据预处理结束 ==============================

2025-05-18 16:53:05,127 - __main__ - INFO - ============================== 开始模型加载 ==============================
2025-05-18 16:53:05,127 - __main__ - INFO - 检查模型加载所需的前置变量...
2025-05-18 16:53:05,128 - __main__ - INFO - 所有模型加载所需的前置变量均已定义
2025-05-18 16:53:05,128 - __main__ - INFO - 开始加载序列分类模型...
2025-05-18 16:53:05,129 - __main__ - INFO - 尝试从本地路径 '/root/.cache/huggingface/hub/models--hfl--chinese-roberta-wwm-ext-large/snapshots/a25cc9e05974bd9687e528edd516f2cfdb3f5db9' 加载模型 (类别数: 14)...
2025-05-18 16:53:07,455 - __main__ - INFO - 模型成功从本地路径 '/root/.cache/huggingface/hub/models--hfl--chinese-roberta-wwm-ext-large/snapshots/a25cc9e05974bd9687e528edd516f2cfdb3f5db9' 加载
2025-05-18 16:53:07,787 - __main__ - INFO - 模型已成功移至设备: cuda.
2025-05-18 16:53:07,792 - __main__ - INFO - 模型总参数量: 325,536,782
2025-05-18 16:53:07,792 - __main__ - INFO - 模型可训练参数量: 325,536,782
2025-05-18 16:53:07,793 - __main__ - INFO - 模型 '/root/.cache/huggingface/hub/models--hfl--chinese-roberta-wwm-ext-large/snapshots/a25cc9e05974bd9687e528edd516f2cfdb3f5db9' (基于 'hfl/chinese-roberta-wwm-ext-large' 结构) 加载并配置完成
2025-05-18 16:53:07,793 - __main__ - INFO - ============================== 模型加载结束 ==============================

2025-05-18 16:53:07,811 - __main__ - INFO - ============================== 开始配置 DataLoaders ==============================
2025-05-18 16:53:07,812 - __main__ - INFO - 检查 DataLoader 配置所需的前置变量...
2025-05-18 16:53:07,812 - __main__ - INFO - 所有 DataLoader 配置所需的核心前置变量均已定义
2025-05-18 16:53:07,813 - __main__ - INFO - DataLoader 配置参数: Batch Size=256, Num Workers=6
2025-05-18 16:53:07,813 - __main__ - INFO - 创建 DataCollatorWithPadding...
2025-05-18 16:53:07,814 - __main__ - INFO - DataCollatorWithPadding 创建成功
2025-05-18 16:53:07,814 - __main__ - INFO - 为训练集 DataLoader 设置 pin_memory=True
2025-05-18 16:53:07,815 - __main__ - INFO - 创建训练集 DataLoader (Batch Size: 256, Shuffle: True, Num Workers: 6, Pin Memory: True)
2025-05-18 16:53:07,815 - __main__ - INFO - 训练集 DataLoader 创建成功
2025-05-18 16:53:07,816 - __main__ - INFO - 创建验证集 DataLoader (Batch Size: 256, Shuffle: False, Num Workers: 6, Pin Memory: True)
2025-05-18 16:53:07,816 - __main__ - INFO - 验证集 DataLoader 创建成功
2025-05-18 16:53:07,817 - __main__ - INFO - 创建测试集 DataLoader (Batch Size: 256, Shuffle: False, Num Workers: 6, Pin Memory: True)
2025-05-18 16:53:07,817 - __main__ - INFO - 测试集 DataLoader 创建成功
2025-05-18 16:53:07,818 - __main__ - INFO - 所有 DataLoader 配置完成
2025-05-18 16:53:07,818 - __main__ - INFO - -------------------- 检查训练 DataLoader 输出 --------------------
2025-05-18 16:53:08,669 - __main__ - INFO - 成功从 train_data_loader 获取一个批次
2025-05-18 16:53:08,670 - __main__ - INFO - 批次包含的键: ['input_ids', 'attention_mask', 'labels']
2025-05-18 16:53:08,671 - __main__ - INFO -   - 'input_ids': shape=torch.Size([256, 28]), dtype=torch.int64, device=cpu
2025-05-18 16:53:08,671 - __main__ - INFO -   - 'attention_mask': shape=torch.Size([256, 28]), dtype=torch.int64, device=cpu
2025-05-18 16:53:08,672 - __main__ - INFO -   - 'labels': shape=torch.Size([256]), dtype=torch.int64, device=cpu
2025-05-18 16:53:08,673 - __main__ - INFO - DataLoader 配置已准备就绪，后续步骤可以定义优化器、学习率调度器等
2025-05-18 16:53:08,673 - __main__ - INFO - ============================== DataLoaders 配置结束 ==============================

2025-05-18 16:53:08,690 - __main__ - INFO - ============================== 开始配置优化器、学习率调度器与评估指标 ==============================
2025-05-18 16:53:08,691 - __main__ - INFO - 检查优化器等配置所需的前置变量...
2025-05-18 16:53:08,691 - __main__ - INFO - 所有优化器等配置所需的前置变量均已定义
2025-05-18 16:53:08,692 - __main__ - INFO - 训练超参数: Learning Rate=2e-05, Epochs=6, Warmup Proportion=0.1, Weight Decay=0.01
2025-05-18 16:53:08,692 - __main__ - INFO - 定义优化器 (AdamW)...
2025-05-18 16:53:08,694 - __main__ - INFO - AdamW 优化器创建成功Learning Rate: 2e-05, Weight Decay: 0.01, Eps: 1e-8
2025-05-18 16:53:08,695 - __main__ - INFO - 定义学习率调度器 (get_linear_schedule_with_warmup)...
2025-05-18 16:53:08,695 - __main__ - INFO - 总训练步数 (for LR Scheduler): 17640
2025-05-18 16:53:08,696 - __main__ - INFO - 预热步数 (Warmup Steps): 1764
2025-05-18 16:53:08,696 - __main__ - INFO - 学习率调度器创建成功
2025-05-18 16:53:08,696 - __main__ - INFO - 定义评估指标 (Accuracy 和 F1-Score 使用 evaluate.load)...
2025-05-18 16:53:08,706 - __main__ - INFO - Accuracy 指标加载成功
2025-05-18 16:53:08,716 - __main__ - INFO - F1-Score 指标加载成功
2025-05-18 16:53:08,717 - __main__ - INFO - 评估指标加载过程完成
2025-05-18 16:53:08,721 - __main__ - INFO - 超参数已记录到 TensorBoard: ./files/logs/tensorboard_runs/20250518-165241
2025-05-18 16:53:08,721 - __main__ - INFO - 优化器、学习率调度器、评估指标配置完成
2025-05-18 16:53:08,721 - __main__ - INFO - ============================== 优化器等配置结束 ==============================

2025-05-18 16:53:51,499 - __main__ - INFO - ============================== 开始模型训练与验证 ==============================
2025-05-18 16:53:51,500 - __main__ - INFO - 检查训练与验证所需的前置变量...
2025-05-18 16:53:51,501 - __main__ - INFO - 所有训练与验证所需的前置变量均已定义。
2025-05-18 16:53:51,502 - __main__ - INFO - 早停机制已启用: Patience=10, Metric='val_loss', Min Delta=0.001
2025-05-18 16:53:51,502 - __main__ - INFO - 早停监控模式: min (指标: val_loss)
2025-05-18 16:53:51,503 - __main__ - INFO - 按步数验证策略已启用：每训练 588 步 (约占epoch的 20.0%) 进行一次验证。
2025-05-18 16:53:56,385 - __main__ - INFO - --- Epoch 1/6 ---
2025-05-18 17:01:24,592 - __main__ - INFO - 开始验证... Epoch 1, Step 588/2940
2025-05-18 17:02:51,956 - __main__ - INFO - 验证完成. 平均验证损失: 0.2121
2025-05-18 17:02:52,044 - __main__ - INFO -   验证准确率 (Accuracy): 0.9372
2025-05-18 17:02:52,151 - __main__ - INFO -   验证加权 F1-Score: 0.9371
2025-05-18 17:02:52,153 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9372 at Epoch 1, Step 588/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 17:03:23,418 - __main__ - INFO - 早停指标改善: val_loss 从 inf -> 0.2121. 重置Patience计数器。
2025-05-18 17:10:50,672 - __main__ - INFO - 开始验证... Epoch 1, Step 1176/2940
2025-05-18 17:12:18,069 - __main__ - INFO - 验证完成. 平均验证损失: 0.1575
2025-05-18 17:12:18,167 - __main__ - INFO -   验证准确率 (Accuracy): 0.9511
2025-05-18 17:12:18,282 - __main__ - INFO -   验证加权 F1-Score: 0.9512
2025-05-18 17:12:18,285 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9511 at Epoch 1, Step 1176/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 17:12:19,630 - __main__ - INFO - 早停指标改善: val_loss 从 0.2121 -> 0.1575. 重置Patience计数器。
2025-05-18 17:19:47,743 - __main__ - INFO - 开始验证... Epoch 1, Step 1764/2940
2025-05-18 17:21:15,318 - __main__ - INFO - 验证完成. 平均验证损失: 0.1400
2025-05-18 17:21:15,407 - __main__ - INFO -   验证准确率 (Accuracy): 0.9556
2025-05-18 17:21:15,519 - __main__ - INFO -   验证加权 F1-Score: 0.9555
2025-05-18 17:21:15,522 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9556 at Epoch 1, Step 1764/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 17:21:17,227 - __main__ - INFO - 早停指标改善: val_loss 从 0.1575 -> 0.1400. 重置Patience计数器。
2025-05-18 17:29:43,644 - __main__ - INFO - 开始验证... Epoch 1, Step 2352/2940
2025-05-18 17:31:10,460 - __main__ - INFO - 验证完成. 平均验证损失: 0.1220
2025-05-18 17:31:10,547 - __main__ - INFO -   验证准确率 (Accuracy): 0.9607
2025-05-18 17:31:10,656 - __main__ - INFO -   验证加权 F1-Score: 0.9607
2025-05-18 17:31:10,659 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9607 at Epoch 1, Step 2352/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 17:31:12,590 - __main__ - INFO - 早停指标改善: val_loss 从 0.1400 -> 0.1220. 重置Patience计数器。
2025-05-18 17:39:08,717 - __main__ - INFO - 开始验证... Epoch 1, Step 2940/2940
2025-05-18 17:40:36,115 - __main__ - INFO - 验证完成. 平均验证损失: 0.1011
2025-05-18 17:40:36,263 - __main__ - INFO -   验证准确率 (Accuracy): 0.9673
2025-05-18 17:40:36,446 - __main__ - INFO -   验证加权 F1-Score: 0.9673
2025-05-18 17:40:36,449 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9673 at Epoch 1, Step 2940/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 17:40:38,248 - __main__ - INFO - 早停指标改善: val_loss 从 0.1220 -> 0.1011. 重置Patience计数器。
2025-05-18 17:40:38,388 - __main__ - INFO - Epoch 1 训练阶段完成. 平均训练损失: 0.3092
2025-05-18 17:40:38,389 - __main__ - INFO - Epoch 1 总耗时: 2802.00 秒
2025-05-18 17:40:38,389 - __main__ - INFO - --- Epoch 2/6 ---
2025-05-18 17:48:08,298 - __main__ - INFO - 开始验证... Epoch 2, Step 588/2940
2025-05-18 17:49:35,714 - __main__ - INFO - 验证完成. 平均验证损失: 0.0918
2025-05-18 17:49:35,800 - __main__ - INFO -   验证准确率 (Accuracy): 0.9709
2025-05-18 17:49:35,910 - __main__ - INFO -   验证加权 F1-Score: 0.9709
2025-05-18 17:49:35,913 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9709 at Epoch 2, Step 588/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 17:49:37,562 - __main__ - INFO - 早停指标改善: val_loss 从 0.1011 -> 0.0918. 重置Patience计数器。
2025-05-18 17:57:34,415 - __main__ - INFO - 开始验证... Epoch 2, Step 1176/2940
2025-05-18 17:59:01,039 - __main__ - INFO - 验证完成. 平均验证损失: 0.0819
2025-05-18 17:59:01,126 - __main__ - INFO -   验证准确率 (Accuracy): 0.9735
2025-05-18 17:59:01,238 - __main__ - INFO -   验证加权 F1-Score: 0.9734
2025-05-18 17:59:01,241 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9735 at Epoch 2, Step 1176/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 17:59:02,905 - __main__ - INFO - 早停指标改善: val_loss 从 0.0918 -> 0.0819. 重置Patience计数器。
2025-05-18 18:06:29,843 - __main__ - INFO - 开始验证... Epoch 2, Step 1764/2940
2025-05-18 18:07:57,025 - __main__ - INFO - 验证完成. 平均验证损失: 0.0737
2025-05-18 18:07:57,110 - __main__ - INFO -   验证准确率 (Accuracy): 0.9760
2025-05-18 18:07:57,220 - __main__ - INFO -   验证加权 F1-Score: 0.9760
2025-05-18 18:07:57,223 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9760 at Epoch 2, Step 1764/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 18:07:58,965 - __main__ - INFO - 早停指标改善: val_loss 从 0.0819 -> 0.0737. 重置Patience计数器。
2025-05-18 18:16:23,903 - __main__ - INFO - 开始验证... Epoch 2, Step 2352/2940
2025-05-18 18:17:50,687 - __main__ - INFO - 验证完成. 平均验证损失: 0.0685
2025-05-18 18:17:50,773 - __main__ - INFO -   验证准确率 (Accuracy): 0.9775
2025-05-18 18:17:50,882 - __main__ - INFO -   验证加权 F1-Score: 0.9775
2025-05-18 18:17:50,885 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9775 at Epoch 2, Step 2352/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 18:17:52,465 - __main__ - INFO - 早停指标改善: val_loss 从 0.0737 -> 0.0685. 重置Patience计数器。
2025-05-18 18:25:19,628 - __main__ - INFO - 开始验证... Epoch 2, Step 2940/2940
2025-05-18 18:26:46,369 - __main__ - INFO - 验证完成. 平均验证损失: 0.0617
2025-05-18 18:26:46,453 - __main__ - INFO -   验证准确率 (Accuracy): 0.9798
2025-05-18 18:26:46,578 - __main__ - INFO -   验证加权 F1-Score: 0.9799
2025-05-18 18:26:46,581 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9798 at Epoch 2, Step 2940/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 18:27:17,883 - __main__ - INFO - 早停指标改善: val_loss 从 0.0685 -> 0.0617. 重置Patience计数器。
2025-05-18 18:27:18,013 - __main__ - INFO - Epoch 2 训练阶段完成. 平均训练损失: 0.1079
2025-05-18 18:27:18,014 - __main__ - INFO - Epoch 2 总耗时: 2799.63 秒
2025-05-18 18:27:18,015 - __main__ - INFO - --- Epoch 3/6 ---
2025-05-18 18:35:45,146 - __main__ - INFO - 开始验证... Epoch 3, Step 588/2940
2025-05-18 18:37:11,327 - __main__ - INFO - 验证完成. 平均验证损失: 0.0581
2025-05-18 18:37:11,421 - __main__ - INFO -   验证准确率 (Accuracy): 0.9804
2025-05-18 18:37:11,541 - __main__ - INFO -   验证加权 F1-Score: 0.9804
2025-05-18 18:37:11,544 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9804 at Epoch 3, Step 588/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 18:37:13,227 - __main__ - INFO - 早停指标改善: val_loss 从 0.0617 -> 0.0581. 重置Patience计数器。
2025-05-18 18:45:07,384 - __main__ - INFO - 开始验证... Epoch 3, Step 1176/2940
2025-05-18 18:46:34,552 - __main__ - INFO - 验证完成. 平均验证损失: 0.0497
2025-05-18 18:46:34,640 - __main__ - INFO -   验证准确率 (Accuracy): 0.9835
2025-05-18 18:46:34,750 - __main__ - INFO -   验证加权 F1-Score: 0.9835
2025-05-18 18:46:34,753 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9835 at Epoch 3, Step 1176/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 18:46:36,629 - __main__ - INFO - 早停指标改善: val_loss 从 0.0581 -> 0.0497. 重置Patience计数器。
2025-05-18 18:54:02,407 - __main__ - INFO - 开始验证... Epoch 3, Step 1764/2940
2025-05-18 18:55:29,599 - __main__ - INFO - 验证完成. 平均验证损失: 0.0443
2025-05-18 18:55:29,686 - __main__ - INFO -   验证准确率 (Accuracy): 0.9853
2025-05-18 18:55:29,796 - __main__ - INFO -   验证加权 F1-Score: 0.9853
2025-05-18 18:55:29,799 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9853 at Epoch 3, Step 1764/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 18:55:31,447 - __main__ - INFO - 早停指标改善: val_loss 从 0.0497 -> 0.0443. 重置Patience计数器。
2025-05-18 19:03:55,575 - __main__ - INFO - 开始验证... Epoch 3, Step 2352/2940
2025-05-18 19:05:22,090 - __main__ - INFO - 验证完成. 平均验证损失: 0.0418
2025-05-18 19:05:22,177 - __main__ - INFO -   验证准确率 (Accuracy): 0.9861
2025-05-18 19:05:22,287 - __main__ - INFO -   验证加权 F1-Score: 0.9861
2025-05-18 19:05:22,290 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9861 at Epoch 3, Step 2352/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 19:05:53,903 - __main__ - INFO - 早停指标改善: val_loss 从 0.0443 -> 0.0418. 重置Patience计数器。
2025-05-18 19:13:18,902 - __main__ - INFO - 开始验证... Epoch 3, Step 2940/2940
2025-05-18 19:14:45,421 - __main__ - INFO - 验证完成. 平均验证损失: 0.0371
2025-05-18 19:14:45,507 - __main__ - INFO -   验证准确率 (Accuracy): 0.9879
2025-05-18 19:14:45,616 - __main__ - INFO -   验证加权 F1-Score: 0.9879
2025-05-18 19:14:45,618 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9879 at Epoch 3, Step 2940/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 19:14:47,255 - __main__ - INFO - 早停指标改善: val_loss 从 0.0418 -> 0.0371. 重置Patience计数器。
2025-05-18 19:14:47,385 - __main__ - INFO - Epoch 3 训练阶段完成. 平均训练损失: 0.0681
2025-05-18 19:14:47,386 - __main__ - INFO - Epoch 3 总耗时: 2849.37 秒
2025-05-18 19:14:47,387 - __main__ - INFO - --- Epoch 4/6 ---
2025-05-18 19:22:44,383 - __main__ - INFO - 开始验证... Epoch 4, Step 588/2940
2025-05-18 19:24:11,439 - __main__ - INFO - 验证完成. 平均验证损失: 0.0292
2025-05-18 19:24:11,524 - __main__ - INFO -   验证准确率 (Accuracy): 0.9906
2025-05-18 19:24:11,631 - __main__ - INFO -   验证加权 F1-Score: 0.9906
2025-05-18 19:24:11,634 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9906 at Epoch 4, Step 588/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 19:24:12,943 - __main__ - INFO - 早停指标改善: val_loss 从 0.0371 -> 0.0292. 重置Patience计数器。
2025-05-18 19:31:39,574 - __main__ - INFO - 开始验证... Epoch 4, Step 1176/2940
2025-05-18 19:33:06,182 - __main__ - INFO - 验证完成. 平均验证损失: 0.0267
2025-05-18 19:33:06,267 - __main__ - INFO -   验证准确率 (Accuracy): 0.9917
2025-05-18 19:33:06,375 - __main__ - INFO -   验证加权 F1-Score: 0.9916
2025-05-18 19:33:06,377 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9917 at Epoch 4, Step 1176/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 19:33:07,685 - __main__ - INFO - 早停指标改善: val_loss 从 0.0292 -> 0.0267. 重置Patience计数器。
2025-05-18 19:41:02,534 - __main__ - INFO - 开始验证... Epoch 4, Step 1764/2940
2025-05-18 19:42:29,198 - __main__ - INFO - 验证完成. 平均验证损失: 0.0245
2025-05-18 19:42:29,284 - __main__ - INFO -   验证准确率 (Accuracy): 0.9925
2025-05-18 19:42:29,394 - __main__ - INFO -   验证加权 F1-Score: 0.9925
2025-05-18 19:42:29,397 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9925 at Epoch 4, Step 1764/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 19:42:31,001 - __main__ - INFO - 早停指标改善: val_loss 从 0.0267 -> 0.0245. 重置Patience计数器。
2025-05-18 19:50:26,824 - __main__ - INFO - 开始验证... Epoch 4, Step 2352/2940
2025-05-18 19:51:54,084 - __main__ - INFO - 验证完成. 平均验证损失: 0.0222
2025-05-18 19:51:54,170 - __main__ - INFO -   验证准确率 (Accuracy): 0.9931
2025-05-18 19:51:54,279 - __main__ - INFO -   验证加权 F1-Score: 0.9931
2025-05-18 19:51:54,282 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9931 at Epoch 4, Step 2352/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 19:51:55,920 - __main__ - INFO - 早停指标改善: val_loss 从 0.0245 -> 0.0222. 重置Patience计数器。
2025-05-18 19:59:51,221 - __main__ - INFO - 开始验证... Epoch 4, Step 2940/2940
2025-05-18 20:01:18,428 - __main__ - INFO - 验证完成. 平均验证损失: 0.0181
2025-05-18 20:01:18,516 - __main__ - INFO -   验证准确率 (Accuracy): 0.9949
2025-05-18 20:01:18,623 - __main__ - INFO -   验证加权 F1-Score: 0.9949
2025-05-18 20:01:18,626 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9949 at Epoch 4, Step 2940/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 20:01:20,257 - __main__ - INFO - 早停指标改善: val_loss 从 0.0222 -> 0.0181. 重置Patience计数器。
2025-05-18 20:01:20,404 - __main__ - INFO - Epoch 4 训练阶段完成. 平均训练损失: 0.0415
2025-05-18 20:01:20,406 - __main__ - INFO - Epoch 4 总耗时: 2793.02 秒
2025-05-18 20:01:20,406 - __main__ - INFO - --- Epoch 5/6 ---
2025-05-18 20:09:47,510 - __main__ - INFO - 开始验证... Epoch 5, Step 588/2940
2025-05-18 20:11:14,010 - __main__ - INFO - 验证完成. 平均验证损失: 0.0156
2025-05-18 20:11:14,098 - __main__ - INFO -   验证准确率 (Accuracy): 0.9951
2025-05-18 20:11:14,205 - __main__ - INFO -   验证加权 F1-Score: 0.9951
2025-05-18 20:11:14,208 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9951 at Epoch 5, Step 588/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 20:11:15,824 - __main__ - INFO - 早停指标改善: val_loss 从 0.0181 -> 0.0156. 重置Patience计数器。
2025-05-18 20:19:10,396 - __main__ - INFO - 开始验证... Epoch 5, Step 1176/2940
2025-05-18 20:20:36,903 - __main__ - INFO - 验证完成. 平均验证损失: 0.0151
2025-05-18 20:20:36,991 - __main__ - INFO -   验证准确率 (Accuracy): 0.9956
2025-05-18 20:20:37,097 - __main__ - INFO -   验证加权 F1-Score: 0.9956
2025-05-18 20:20:37,100 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9956 at Epoch 5, Step 1176/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 20:20:38,488 - __main__ - INFO - 早停指标未改善 (val_loss: 0.0151 vs best: 0.0156). Patience: 1/10
2025-05-18 20:28:05,200 - __main__ - INFO - 开始验证... Epoch 5, Step 1764/2940
2025-05-18 20:29:32,656 - __main__ - INFO - 验证完成. 平均验证损失: 0.0128
2025-05-18 20:29:32,743 - __main__ - INFO -   验证准确率 (Accuracy): 0.9963
2025-05-18 20:29:32,863 - __main__ - INFO -   验证加权 F1-Score: 0.9963
2025-05-18 20:29:32,866 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9963 at Epoch 5, Step 1764/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 20:29:34,700 - __main__ - INFO - 早停指标改善: val_loss 从 0.0156 -> 0.0128. 重置Patience计数器。
2025-05-18 20:37:30,542 - __main__ - INFO - 开始验证... Epoch 5, Step 2352/2940
2025-05-18 20:38:57,923 - __main__ - INFO - 验证完成. 平均验证损失: 0.0118
2025-05-18 20:38:58,009 - __main__ - INFO -   验证准确率 (Accuracy): 0.9964
2025-05-18 20:38:58,136 - __main__ - INFO -   验证加权 F1-Score: 0.9964
2025-05-18 20:38:58,139 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9964 at Epoch 5, Step 2352/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 20:38:59,486 - __main__ - INFO - 早停指标未改善 (val_loss: 0.0118 vs best: 0.0128). Patience: 1/10
2025-05-18 20:46:26,353 - __main__ - INFO - 开始验证... Epoch 5, Step 2940/2940
2025-05-18 20:47:53,068 - __main__ - INFO - 验证完成. 平均验证损失: 0.0102
2025-05-18 20:47:53,153 - __main__ - INFO -   验证准确率 (Accuracy): 0.9970
2025-05-18 20:47:53,258 - __main__ - INFO -   验证加权 F1-Score: 0.9970
2025-05-18 20:47:53,261 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9970 at Epoch 5, Step 2940/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 20:48:24,842 - __main__ - INFO - 早停指标改善: val_loss 从 0.0128 -> 0.0102. 重置Patience计数器。
2025-05-18 20:48:24,968 - __main__ - INFO - Epoch 5 训练阶段完成. 平均训练损失: 0.0245
2025-05-18 20:48:24,969 - __main__ - INFO - Epoch 5 总耗时: 2824.56 秒
2025-05-18 20:48:24,969 - __main__ - INFO - --- Epoch 6/6 ---
2025-05-18 20:56:51,112 - __main__ - INFO - 开始验证... Epoch 6, Step 588/2940
2025-05-18 20:58:17,904 - __main__ - INFO - 验证完成. 平均验证损失: 0.0092
2025-05-18 20:58:17,991 - __main__ - INFO -   验证准确率 (Accuracy): 0.9974
2025-05-18 20:58:18,097 - __main__ - INFO -   验证加权 F1-Score: 0.9974
2025-05-18 20:58:18,100 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9974 at Epoch 6, Step 588/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 20:58:19,458 - __main__ - INFO - 早停指标改善: val_loss 从 0.0102 -> 0.0092. 重置Patience计数器。
2025-05-18 21:06:15,712 - __main__ - INFO - 开始验证... Epoch 6, Step 1176/2940
2025-05-18 21:07:43,140 - __main__ - INFO - 验证完成. 平均验证损失: 0.0088
2025-05-18 21:07:43,227 - __main__ - INFO -   验证准确率 (Accuracy): 0.9974
2025-05-18 21:07:43,334 - __main__ - INFO -   验证加权 F1-Score: 0.9974
2025-05-18 21:07:43,337 - __main__ - INFO - 当前验证 Accuracy 0.9974 未超过历史最佳 0.9974 (at Epoch 6, Step 1176/2940).
2025-05-18 21:07:43,338 - __main__ - INFO - 早停指标未改善 (val_loss: 0.0088 vs best: 0.0092). Patience: 1/10
2025-05-18 21:15:41,175 - __main__ - INFO - 开始验证... Epoch 6, Step 1764/2940
2025-05-18 21:17:08,202 - __main__ - INFO - 验证完成. 平均验证损失: 0.0078
2025-05-18 21:17:08,287 - __main__ - INFO -   验证准确率 (Accuracy): 0.9978
2025-05-18 21:17:08,394 - __main__ - INFO -   验证加权 F1-Score: 0.9977
2025-05-18 21:17:08,397 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9978 at Epoch 6, Step 1764/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 21:17:09,810 - __main__ - INFO - 早停指标改善: val_loss 从 0.0092 -> 0.0078. 重置Patience计数器。
2025-05-18 21:24:37,235 - __main__ - INFO - 开始验证... Epoch 6, Step 2352/2940
2025-05-18 21:26:04,636 - __main__ - INFO - 验证完成. 平均验证损失: 0.0074
2025-05-18 21:26:04,723 - __main__ - INFO -   验证准确率 (Accuracy): 0.9979
2025-05-18 21:26:04,832 - __main__ - INFO -   验证加权 F1-Score: 0.9979
2025-05-18 21:26:04,835 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9979 at Epoch 6, Step 2352/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 21:26:36,638 - __main__ - INFO - 早停指标未改善 (val_loss: 0.0074 vs best: 0.0078). Patience: 1/10
2025-05-18 21:34:02,566 - __main__ - INFO - 开始验证... Epoch 6, Step 2940/2940
2025-05-18 21:35:29,945 - __main__ - INFO - 验证完成. 平均验证损失: 0.0070
2025-05-18 21:35:30,030 - __main__ - INFO -   验证准确率 (Accuracy): 0.9980
2025-05-18 21:35:30,133 - __main__ - INFO -   验证加权 F1-Score: 0.9980
2025-05-18 21:35:30,136 - __main__ - INFO - 🎉 新的最佳模型 (基于Accuracy)! Accuracy: 0.9980 at Epoch 6, Step 2940/2940. 保存模型到 ./files/saved_models/best_roberta_model.pt
2025-05-18 21:35:31,870 - __main__ - INFO - 早停指标未改善 (val_loss: 0.0070 vs best: 0.0078). Patience: 2/10
2025-05-18 21:35:31,990 - __main__ - INFO - Epoch 6 训练阶段完成. 平均训练损失: 0.0141
2025-05-18 21:35:31,991 - __main__ - INFO - Epoch 6 总耗时: 2827.02 秒
2025-05-18 21:35:31,991 - __main__ - INFO - 所有计划的 Epoch 训练与验证完成。
2025-05-18 21:35:31,992 - __main__ - INFO - 训练期间记录的最佳模型信息: Epoch=6, Step=2940, Val Accuracy=0.9980, Val F1=0.9980, Val Loss=0.0070
2025-05-18 21:35:31,992 - __main__ - INFO - 最佳模型参数已保存至: ./files/saved_models/best_roberta_model.pt (对应验证准确率: 0.9980)
2025-05-18 21:35:31,992 - __main__ - INFO - 总训练耗时: 04小时 41分钟 35.61秒
2025-05-18 21:35:31,993 - __main__ - INFO - TensorBoard 日志已保存到: ./files/logs/tensorboard_runs/20250518-165241
2025-05-18 21:35:31,994 - __main__ - INFO - ============================== 模型训练与验证结束 ==============================

2025-05-18 21:35:31,994 - __main__ - INFO - 第一次微调完成，准备进行内存清理...
2025-05-18 21:35:31,995 - __main__ - INFO - 已删除第一次微调的优化器 (optimizer)。
2025-05-18 21:35:31,999 - __main__ - INFO - 已删除第一次微调的学习率调度器 (lr_scheduler)。
2025-05-18 21:35:31,999 - __main__ - INFO - 已删除原始训练数据加载器 (train_data_loader)。
2025-05-18 21:35:32,000 - __main__ - INFO - 已删除原始训练数据集对象 (train_dataset)。
2025-05-18 21:35:32,008 - __main__ - INFO - 当前CUDA显存已分配: 2502.73 MB
2025-05-18 21:35:32,009 - __main__ - INFO - 当前CUDA显存已缓存: 16290.00 MB
2025-05-18 21:35:32,258 - __main__ - INFO - 已尝试清空CUDA缓存。
2025-05-18 21:35:32,259 - __main__ - INFO - 清空缓存后CUDA显存已分配: 2502.73 MB
2025-05-18 21:35:32,259 - __main__ - INFO - 清空缓存后CUDA显存已缓存: 3322.00 MB
2025-05-18 21:36:02,317 - __main__ - INFO - ============================== 开始测试集预测分析与数据增强样本生成 ==============================
2025-05-18 21:36:02,318 - __main__ - INFO - 检查分析模块所需的前置变量...
2025-05-18 21:36:02,319 - __main__ - INFO - 所有分析模块所需的前置变量均已定义
2025-05-18 21:36:02,320 - __main__ - INFO - 加载最佳模型权重从: ./files/saved_models/best_roberta_model.pt
2025-05-18 21:36:03,128 - __main__ - INFO - 最佳模型权重加载成功
2025-05-18 21:36:03,131 - __main__ - INFO - 开始对所有测试数据进行 Top-1 预测...
2025-05-18 21:37:34,207 - __main__ - INFO - Top-1 预测处理完成，共获得 83599 条预测结果
2025-05-18 21:37:34,635 - __main__ - INFO - 全量测试集 Top-1 预测结果已保存至 JSON: ./files/analysis_results/all_test_analysis/test_top1_predictions.json
2025-05-18 21:37:34,635 - __main__ - INFO - JSON结果示例 (第一条):
2025-05-18 21:37:34,636 - __main__ - INFO - {
  "original_id": 0,
  "text": "北京君太百货璀璨秋色 满100省353020元",
  "predicted_label": "房产",
  "probability": 0.999
}
2025-05-18 21:37:34,636 - __main__ - INFO - 开始统计和绘制 Top-1 预测概率分布图...
2025-05-18 21:38:05,847 - __main__ - INFO - 概率分布柱状图已保存至: ./files/analysis_results/all_test_analysis/test_prob_distribution.png
2025-05-18 21:38:05,969 - __main__ - INFO - 概率分布图已尝试记录到 TensorBoard
2025-05-18 21:38:05,981 - __main__ - INFO - 概率分布数据已保存至 CSV: ./files/analysis_results/all_test_analysis/test_prob_distribution_data.csv
2025-05-18 21:38:05,982 - __main__ - INFO - 开始根据 Top-1 预测概率生成数据增强文件 (选取前 80% 高置信度样本)...
2025-05-18 21:38:05,996 - __main__ - INFO - 将选取 66879 条样本用于数据增强
2025-05-18 21:38:05,997 - __main__ - INFO -   这些样本的 Top-1 预测概率范围从 1.000 到 0.999
2025-05-18 21:38:06,047 - __main__ - INFO - 成功将 66879 条预测写入数据增强文件: ./files/raw_data/train_add.txt
2025-05-18 21:38:06,047 - __main__ - INFO - 数据增强文件内容示例 (前3行):
2025-05-18 21:38:06,048 - __main__ - INFO -   专业级单反相机 佳能7D单机售价9280元	科技
2025-05-18 21:38:06,048 - __main__ - INFO -   星展银行起诉内地客户 银行强硬客户无奈	股票
2025-05-18 21:38:06,049 - __main__ - INFO -   内城土地稀缺 对开发商提出更高要求(组图)	房产
2025-05-18 21:38:06,049 - __main__ - INFO - ============================== 测试集预测分析与数据增强样本生成结束 ==============================

2025-05-18 21:38:06,077 - __main__ - INFO - ============================== 开始使用增强数据进行二次微调 ==============================
2025-05-18 21:38:06,078 - __main__ - INFO - 检查二次微调所需的前置变量...
2025-05-18 21:38:06,078 - __main__ - INFO - 所有二次微调所需的前置变量均已定义。
2025-05-18 21:38:06,079 - __main__ - INFO - 开始加载数据增强文件: ./files/raw_data/train_add.txt
2025-05-18 21:38:06,079 - __main__ - INFO - 开始从文件加载数据: ./files/raw_data/train_add.txt
2025-05-18 21:38:06,136 - __main__ - INFO - 从 ./files/raw_data/train_add.txt 成功加载 66879 条数据
2025-05-18 21:38:06,137 - __main__ - INFO - 成功从 ./files/raw_data/train_add.txt 加载 66879 条增强训练数据。
2025-05-18 21:38:06,137 - __main__ - INFO - 开始预处理增强训练数据...
2025-05-18 21:38:06,138 - __main__ - INFO - 未找到增强训练数据缓存，正在重新处理: ./files/processed_data_cache/aug_train_dataset_cache
2025-05-18 21:38:06,138 - __main__ - INFO - 开始为 '增强训练集' 创建 HuggingFace Dataset 对象...
2025-05-18 21:38:06,209 - __main__ - INFO - '增强训练集' Dataset 对象创建成功，包含 66879 条记录
2025-05-18 21:38:06,209 - __main__ - INFO - 开始对 '增强训练集' 进行并行预处理 (使用 12 个进程)...
2025-05-18 21:38:09,535 - __main__ - INFO - '增强训练集' 预处理完成
2025-05-18 21:38:09,536 - __main__ - INFO - 保存预处理后的增强训练集到: ./files/processed_data_cache/aug_train_dataset_cache
2025-05-18 21:38:09,581 - __main__ - INFO - 增强训练数据预处理完成并已保存到磁盘缓存。
2025-05-18 21:38:09,582 - __main__ - INFO - 增强训练数据集格式已设置为 PyTorch Tensors。
2025-05-18 21:38:09,583 - __main__ - INFO - 创建增强训练数据的 DataLoader...
2025-05-18 21:38:09,584 - __main__ - INFO - 增强训练数据 DataLoader 创建成功 (Batch Size: 256, Num Workers: 0)。
2025-05-18 21:38:09,584 - __main__ - INFO - 加载第一阶段微调后的最佳模型权重从: ./files/saved_models/best_roberta_model.pt
2025-05-18 21:38:10,942 - __main__ - INFO - 成功加载来自 './files/saved_models/best_roberta_model.pt' 的模型权重。
2025-05-18 21:38:10,942 - __main__ - INFO - 为二次微调配置新的优化器和学习率调度器...
2025-05-18 21:38:10,943 - __main__ - INFO - 二次微调超参数: Learning Rate=2e-05, Epochs=3, Warmup Proportion=0.1, Weight Decay=0.01
2025-05-18 21:38:10,945 - __main__ - INFO - 二次微调 AdamW 优化器创建成功。
2025-05-18 21:38:10,945 - __main__ - INFO - 二次微调总训练步数: 786, 预热步数: 78
2025-05-18 21:38:10,946 - __main__ - INFO - 二次微调学习率调度器创建成功。
2025-05-18 21:38:10,946 - __main__ - INFO - 开始二次微调训练与验证循环...
2025-05-18 21:38:10,947 - __main__ - INFO - 二次微调按步数验证：每 262 步 (约占epoch的 100.0%) 进行一次验证。
2025-05-18 21:38:10,949 - __main__ - INFO - --- 二次微调 Epoch 1/3 ---
2025-05-18 21:41:31,516 - __main__ - INFO - 开始验证... Aug Epoch 1, Step 262/262
2025-05-18 21:42:58,734 - __main__ - INFO - 验证完成. 平均验证损失: 0.0207
2025-05-18 21:42:58,826 - __main__ - INFO -   验证准确率 (Accuracy): 0.9931
2025-05-18 21:42:58,934 - __main__ - INFO -   验证加权 F1-Score: 0.9931
2025-05-18 21:42:58,937 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9931 at Aug Epoch 1, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 21:43:00,115 - __main__ - INFO - 二次微调 Epoch 1 训练阶段完成. 平均训练损失: 0.0096
2025-05-18 21:43:00,116 - __main__ - INFO - 二次微调 Epoch 1 总耗时: 289.17 秒
2025-05-18 21:43:00,116 - __main__ - INFO - --- 二次微调 Epoch 2/3 ---
2025-05-18 21:46:50,349 - __main__ - INFO - 开始验证... Aug Epoch 2, Step 262/262
2025-05-18 21:48:17,394 - __main__ - INFO - 验证完成. 平均验证损失: 0.0196
2025-05-18 21:48:17,483 - __main__ - INFO -   验证准确率 (Accuracy): 0.9937
2025-05-18 21:48:17,587 - __main__ - INFO -   验证加权 F1-Score: 0.9937
2025-05-18 21:48:17,590 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9937 at Aug Epoch 2, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 21:48:19,240 - __main__ - INFO - 二次微调 Epoch 2 训练阶段完成. 平均训练损失: 0.0052
2025-05-18 21:48:19,240 - __main__ - INFO - 二次微调 Epoch 2 总耗时: 319.12 秒
2025-05-18 21:48:19,278 - __main__ - INFO - --- 二次微调 Epoch 3/3 ---
2025-05-18 21:52:09,708 - __main__ - INFO - 开始验证... Aug Epoch 3, Step 262/262
2025-05-18 21:53:36,070 - __main__ - INFO - 验证完成. 平均验证损失: 0.0165
2025-05-18 21:53:36,159 - __main__ - INFO -   验证准确率 (Accuracy): 0.9949
2025-05-18 21:53:36,266 - __main__ - INFO -   验证加权 F1-Score: 0.9949
2025-05-18 21:53:36,268 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9949 at Aug Epoch 3, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 21:53:37,979 - __main__ - INFO - 二次微调 Epoch 3 训练阶段完成. 平均训练损失: 0.0013
2025-05-18 21:53:37,980 - __main__ - INFO - 二次微调 Epoch 3 总耗时: 318.70 秒
2025-05-18 21:53:37,981 - __main__ - INFO - 所有计划的二次微调 Epoch 训练与验证完成。
2025-05-18 21:53:37,981 - __main__ - INFO - 二次微调期间记录的最佳模型信息: Epoch=3, Step=262, Val Accuracy=0.9949, Val F1=0.9949, Val Loss=0.0165
2025-05-18 21:53:37,982 - __main__ - INFO - 最佳二次微调模型参数已保存至: ./files/saved_models/best_augmented_model.pt (对应验证准确率: 0.9949)
2025-05-18 21:53:37,982 - __main__ - INFO - 总二次微调耗时: 00小时 15分钟 27.03秒
2025-05-18 21:53:37,983 - __main__ - INFO - ============================== 使用增强数据进行二次微调结束 ==============================

2025-05-18 21:53:38,008 - __main__ - INFO - ============================== 开始最终测试集预测与结果分析 (使用二次微调模型) ==============================
2025-05-18 21:53:38,009 - __main__ - INFO - 检查最终预测与分析所需的前置变量...
2025-05-18 21:53:38,010 - __main__ - INFO - 所有最终预测分析所需的前置变量均已定义。
2025-05-18 21:53:38,010 - __main__ - INFO - 加载二次微调后的最佳模型权重从: ./files/saved_models/best_augmented_model.pt
2025-05-18 21:53:38,695 - __main__ - INFO - 二次微调后的最佳模型权重从 ./files/saved_models/best_augmented_model.pt 加载成功。
2025-05-18 21:53:38,697 - __main__ - INFO - 开始对所有测试数据进行最终 Top-1 预测 (使用二次微调模型)...
2025-05-18 21:55:09,656 - __main__ - INFO - 最终 Top-1 预测处理完成，共获得 83599 条预测结果。
2025-05-18 21:55:10,086 - __main__ - INFO - 最终测试集 Top-1 预测结果已保存至 JSON: ./files/results/final_test_top1_predictions.json
2025-05-18 21:55:10,087 - __main__ - INFO - JSON结果示例 (第一条):
2025-05-18 21:55:10,087 - __main__ - INFO - {
  "original_id": 0,
  "text": "北京君太百货璀璨秋色 满100省353020元",
  "predicted_label": "房产",
  "probability": 1.0
}
2025-05-18 21:55:10,116 - __main__ - INFO - 成功将 83599 条预测标签写入纯文本文件: ./files/results/result.txt
2025-05-18 21:55:10,117 - __main__ - INFO - result.txt 内容示例 (前3行，如果存在):
2025-05-18 21:55:10,117 - __main__ - INFO -   房产
2025-05-18 21:55:10,118 - __main__ - INFO -   时政
2025-05-18 21:55:10,118 - __main__ - INFO -   科技
2025-05-18 21:55:10,118 - __main__ - INFO - 开始统计和绘制最终 Top-1 预测概率分布图...
2025-05-18 21:55:10,917 - __main__ - INFO - 最终概率分布柱状图已保存至: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution.png
2025-05-18 21:55:11,027 - __main__ - INFO - 最终概率分布图已尝试记录到 TensorBoard。
2025-05-18 21:55:11,043 - __main__ - INFO - 最终概率分布数据已保存至 CSV: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution_data.csv
2025-05-18 21:55:11,043 - __main__ - INFO - ============================== 最终测试集预测与结果分析结束 ==============================

2025-05-18 22:00:51,050 - __main__ - INFO - ============================== 开始使用增强数据进行二次微调 ==============================
2025-05-18 22:00:51,052 - __main__ - INFO - 检查二次微调所需的前置变量...
2025-05-18 22:00:51,052 - __main__ - INFO - 所有二次微调所需的前置变量均已定义。
2025-05-18 22:00:51,053 - __main__ - INFO - 开始加载数据增强文件: ./files/raw_data/train_add.txt
2025-05-18 22:00:51,054 - __main__ - INFO - 开始从文件加载数据: ./files/raw_data/train_add.txt
2025-05-18 22:00:51,112 - __main__ - INFO - 从 ./files/raw_data/train_add.txt 成功加载 66879 条数据
2025-05-18 22:00:51,142 - __main__ - INFO - 成功从 ./files/raw_data/train_add.txt 加载 66879 条增强训练数据。
2025-05-18 22:00:51,143 - __main__ - INFO - 开始预处理增强训练数据...
2025-05-18 22:00:51,143 - __main__ - INFO - 发现预处理好的增强训练数据缓存，正在从磁盘加载: ./files/processed_data_cache/aug_train_dataset_cache
2025-05-18 22:00:51,149 - __main__ - INFO - 从磁盘加载预处理增强训练数据成功。
2025-05-18 22:00:51,150 - __main__ - INFO - 增强训练数据集格式已设置为 PyTorch Tensors。
2025-05-18 22:00:51,150 - __main__ - INFO - 创建增强训练数据的 DataLoader...
2025-05-18 22:00:51,151 - __main__ - INFO - 增强训练数据 DataLoader 创建成功 (Batch Size: 256, Num Workers: 0)。
2025-05-18 22:00:51,151 - __main__ - INFO - 加载第一阶段微调后的最佳模型权重从: ./files/saved_models/best_roberta_model.pt
2025-05-18 22:00:52,177 - __main__ - INFO - 成功加载来自 './files/saved_models/best_roberta_model.pt' 的模型权重。
2025-05-18 22:00:52,178 - __main__ - INFO - 为二次微调配置新的优化器和学习率调度器...
2025-05-18 22:00:52,178 - __main__ - INFO - 二次微调超参数: Learning Rate=2e-05, Epochs=3, Warmup Proportion=0.1, Weight Decay=0.01
2025-05-18 22:00:52,180 - __main__ - INFO - 二次微调 AdamW 优化器创建成功。
2025-05-18 22:00:52,181 - __main__ - INFO - 二次微调总训练步数: 786, 预热步数: 78
2025-05-18 22:00:52,184 - __main__ - INFO - 二次微调学习率调度器创建成功。
2025-05-18 22:00:52,185 - __main__ - INFO - 开始二次微调训练与验证循环...
2025-05-18 22:00:52,185 - __main__ - INFO - 二次微调按步数验证：每 262 步 (约占epoch的 100.0%) 进行一次验证。
2025-05-18 22:00:52,187 - __main__ - INFO - --- 二次微调 Epoch 1/3 ---
2025-05-18 22:04:41,166 - __main__ - INFO - 开始验证... Aug Epoch 1, Step 262/262
2025-05-18 22:06:07,358 - __main__ - INFO - 验证完成. 平均验证损失: 0.0322
2025-05-18 22:06:07,448 - __main__ - INFO -   验证准确率 (Accuracy): 0.9897
2025-05-18 22:06:07,554 - __main__ - INFO -   验证加权 F1-Score: 0.9897
2025-05-18 22:06:07,557 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9897 at Aug Epoch 1, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 22:06:09,297 - __main__ - INFO - 二次微调 Epoch 1 训练阶段完成. 平均训练损失: 0.0066
2025-05-18 22:06:09,298 - __main__ - INFO - 二次微调 Epoch 1 总耗时: 317.11 秒
2025-05-18 22:06:09,334 - __main__ - INFO - --- 二次微调 Epoch 2/3 ---
2025-05-18 22:09:59,621 - __main__ - INFO - 开始验证... Aug Epoch 2, Step 262/262
2025-05-18 22:11:26,277 - __main__ - INFO - 验证完成. 平均验证损失: 0.0344
2025-05-18 22:11:26,368 - __main__ - INFO -   验证准确率 (Accuracy): 0.9896
2025-05-18 22:11:26,478 - __main__ - INFO -   验证加权 F1-Score: 0.9896
2025-05-18 22:11:26,481 - __main__ - INFO - 当前验证 Accuracy 0.9896 未超过二次微调历史最佳 0.9897 (at Aug Epoch 2, Step 262/262).
2025-05-18 22:11:26,483 - __main__ - INFO - 二次微调 Epoch 2 训练阶段完成. 平均训练损失: 0.0030
2025-05-18 22:11:26,484 - __main__ - INFO - 二次微调 Epoch 2 总耗时: 317.15 秒
2025-05-18 22:11:26,484 - __main__ - INFO - --- 二次微调 Epoch 3/3 ---
2025-05-18 22:15:16,680 - __main__ - INFO - 开始验证... Aug Epoch 3, Step 262/262
2025-05-18 22:16:43,389 - __main__ - INFO - 验证完成. 平均验证损失: 0.0322
2025-05-18 22:16:43,482 - __main__ - INFO -   验证准确率 (Accuracy): 0.9903
2025-05-18 22:16:43,591 - __main__ - INFO -   验证加权 F1-Score: 0.9904
2025-05-18 22:16:43,594 - __main__ - INFO - 🎉 新的最佳增强模型 (基于Accuracy)! Accuracy: 0.9903 at Aug Epoch 3, Step 262/262. 保存模型到 ./files/saved_models/best_augmented_model.pt
2025-05-18 22:16:44,901 - __main__ - INFO - 二次微调 Epoch 3 训练阶段完成. 平均训练损失: 0.0010
2025-05-18 22:16:44,902 - __main__ - INFO - 二次微调 Epoch 3 总耗时: 318.42 秒
2025-05-18 22:16:44,902 - __main__ - INFO - 所有计划的二次微调 Epoch 训练与验证完成。
2025-05-18 22:16:44,903 - __main__ - INFO - 二次微调期间记录的最佳模型信息: Epoch=3, Step=262, Val Accuracy=0.9903, Val F1=0.9904, Val Loss=0.0322
2025-05-18 22:16:44,903 - __main__ - INFO - 最佳二次微调模型参数已保存至: ./files/saved_models/best_augmented_model.pt (对应验证准确率: 0.9903)
2025-05-18 22:16:44,904 - __main__ - INFO - 总二次微调耗时: 00小时 15分钟 52.72秒
2025-05-18 22:16:44,904 - __main__ - INFO - ============================== 使用增强数据进行二次微调结束 ==============================

2025-05-18 22:16:44,930 - __main__ - INFO - ============================== 开始最终测试集预测与结果分析 (使用二次微调模型) ==============================
2025-05-18 22:16:44,930 - __main__ - INFO - 检查最终预测与分析所需的前置变量...
2025-05-18 22:16:44,931 - __main__ - INFO - 所有最终预测分析所需的前置变量均已定义。
2025-05-18 22:16:44,932 - __main__ - INFO - 加载二次微调后的最佳模型权重从: ./files/saved_models/best_augmented_model.pt
2025-05-18 22:16:45,649 - __main__ - INFO - 二次微调后的最佳模型权重从 ./files/saved_models/best_augmented_model.pt 加载成功。
2025-05-18 22:16:45,685 - __main__ - INFO - 开始对所有测试数据进行最终 Top-1 预测 (使用二次微调模型)...
2025-05-18 22:18:16,983 - __main__ - INFO - 最终 Top-1 预测处理完成，共获得 83599 条预测结果。
2025-05-18 22:18:17,415 - __main__ - INFO - 最终测试集 Top-1 预测结果已保存至 JSON: ./files/results/final_test_top1_predictions.json
2025-05-18 22:18:17,416 - __main__ - INFO - JSON结果示例 (第一条):
2025-05-18 22:18:17,416 - __main__ - INFO - {
  "original_id": 0,
  "text": "北京君太百货璀璨秋色 满100省353020元",
  "predicted_label": "房产",
  "probability": 0.996
}
2025-05-18 22:18:17,447 - __main__ - INFO - 成功将 83599 条预测标签写入纯文本文件: ./files/results/result.txt
2025-05-18 22:18:17,448 - __main__ - INFO - result.txt 内容示例 (前3行，如果存在):
2025-05-18 22:18:17,448 - __main__ - INFO -   房产
2025-05-18 22:18:17,449 - __main__ - INFO -   时政
2025-05-18 22:18:17,449 - __main__ - INFO -   科技
2025-05-18 22:18:17,449 - __main__ - INFO - 开始统计和绘制最终 Top-1 预测概率分布图...
2025-05-18 22:18:18,270 - __main__ - INFO - 最终概率分布柱状图已保存至: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution.png
2025-05-18 22:18:18,388 - __main__ - INFO - 最终概率分布图已尝试记录到 TensorBoard。
2025-05-18 22:18:18,404 - __main__ - INFO - 最终概率分布数据已保存至 CSV: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution_data.csv
2025-05-18 22:18:18,404 - __main__ - INFO - ============================== 最终测试集预测与结果分析结束 ==============================

2025-05-18 22:20:43,706 - __main__ - INFO - ============================== 开始最终测试集预测与结果分析 (使用二次微调模型) ==============================
2025-05-18 22:20:43,707 - __main__ - INFO - 检查最终预测与分析所需的前置变量...
2025-05-18 22:20:43,708 - __main__ - INFO - 所有最终预测分析所需的前置变量均已定义。
2025-05-18 22:20:43,708 - __main__ - INFO - 加载二次微调后的最佳模型权重从: ./files/saved_models/best_augmented_model.pt
2025-05-18 22:20:44,468 - __main__ - INFO - 二次微调后的最佳模型权重从 ./files/saved_models/best_augmented_model.pt 加载成功。
2025-05-18 22:20:44,479 - __main__ - INFO - 开始对所有测试数据进行最终 Top-1 预测 (使用二次微调模型)...
2025-05-18 22:22:14,496 - __main__ - INFO - 最终 Top-1 预测处理完成，共获得 83599 条预测结果。
2025-05-18 22:22:14,934 - __main__ - INFO - 最终测试集 Top-1 预测结果已保存至 JSON: ./files/results/final_test_top1_predictions.json
2025-05-18 22:22:14,935 - __main__ - INFO - JSON结果示例 (第一条):
2025-05-18 22:22:14,935 - __main__ - INFO - {
  "original_id": 0,
  "text": "北京君太百货璀璨秋色 满100省353020元",
  "predicted_label": "房产",
  "probability": 0.996
}
2025-05-18 22:22:14,968 - __main__ - INFO - 成功将 83599 条预测标签写入纯文本文件: ./files/results/result.txt
2025-05-18 22:22:14,968 - __main__ - INFO - result.txt 内容示例 (前3行，如果存在):
2025-05-18 22:22:14,969 - __main__ - INFO -   房产
2025-05-18 22:22:14,969 - __main__ - INFO -   时政
2025-05-18 22:22:14,969 - __main__ - INFO -   科技
2025-05-18 22:22:14,970 - __main__ - INFO - 开始统计和绘制最终 Top-1 预测概率分布图...
2025-05-18 22:23:46,285 - __main__ - INFO - 最终概率分布柱状图已保存至: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution.png
2025-05-18 22:23:46,390 - __main__ - INFO - 最终概率分布图已尝试记录到 TensorBoard。
2025-05-18 22:23:46,405 - __main__ - INFO - 最终概率分布数据已保存至 CSV: ./files/results/prediction_analysis_charts_csv/final_test_prob_distribution_data.csv
2025-05-18 22:23:46,405 - __main__ - INFO - ============================== 最终测试集预测与结果分析结束 ==============================

